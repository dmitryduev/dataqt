<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- The above 3 meta tags *must* come first in the head; any other head content must come *after* these tags -->
    <meta name="description" content="">
    <meta name="author" content="">
    <!--<link rel="icon" href="favicon.ico">-->

    <title>Robo-AO data quality: {{ date }}</title>

    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="/css/bootstrap.min.css">
    <link rel="stylesheet" href="/css/blueimp-gallery.min.css">
    <link rel="stylesheet" href="/css/bootstrap-image-gallery.min.css">
    <link rel="stylesheet" href="/css/bootstrap-magnify.min.css">

    <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
    <link href="/css/ie10-viewport-bug-workaround.css" rel="stylesheet">

    <!-- Custom styles for this template
    <link href="grid.css" rel="stylesheet">-->

    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

    <!--
    <script>
    document.getElementById('links').onclick = function (event) {
        event = event || window.event;
        var target = event.target || event.srcElement,
            link = target.src ? target.parentNode : target,
            options = {index: link, event: event},
            links = this.getElementsByTagName('a');
        blueimp.Gallery(links, options);
    };
    </script>
    -->
    <script src="/js/bootstrap-magnify.min.js"></script>
    <script>
//        function parseDate(string){
//            var dateString    = string.match(/\d{4}\d{2}\d{2}\s\b\d{2}\d{2}\d{2}/);
//            var dt            = new Date(dateString);
//            return dt;
//        }
        function playCarousel() {
            $('.carousel').carousel('cycle');
            $('#carousel-play').hide();
        }
        function pauseCarousel() {
            $('.carousel').carousel('pause');
            $('#carousel-pause').hide();
            $('#carousel-play').show();
        }
        function pauseCarouselShow() {
            if ($('#carousel-play').css('display') == 'none') {
                $('#carousel-pause').show();
            }
        }
        function pauseCarouselHide() {
            $('#carousel-pause').hide();
        }
//        $( document ).ready(function () {
//            $('.carousel').carousel({
//                interval: 100,
//                pause: "false"
//            });
//            $('#playButton').click(function () {
//                $('.carousel').carousel('cycle');
//            });
//            $('#pauseButton').click(function () {
//                $('.carousel').carousel('pause');
//            });
//        });
    </script>

    <style>
        body {
            padding-top: 70px;
        }
        .main-container {
          padding: 40px 15px;
          text-align: center;
        }
        /*
        .modal-body img:hover {
              -moz-transform: scale(1.5);
              -ms-transform: scale(1.5);
              -o-transform: scale(1.5);
              -webkit-transform: scale(1.5);
              transform: scale(1.5);
        }
        */
        .carousel-fade .carousel-inner .item {
          opacity: 0;
          -webkit-transition: opacity 0.5s;
          -moz-transition: opacity 0.5s;
          -o-transition: opacity 0.5s;
          transition: opacity 0.5s;
        }
        .carousel-control {
            background-image: none !important; /* remove background gradients on controls */
        }
        .carousel-fade .carousel-inner .active {
          opacity: 1;
        }
        .carousel-fade .carousel-inner .active.left,
        .carousel-fade .carousel-inner .active.right {
          left: 0;
          opacity: 0;
          z-index: 1;
        }
        .carousel-fade .carousel-inner .next.left,
        .carousel-fade .carousel-inner .prev.right {
          opacity: 1;
        }
        .carousel-fade .carousel-control {
          z-index: 2;
        }
        @media all and (transform-3d), (-webkit-transform-3d) {
            .carousel-fade .carousel-inner > .item.next,
            .carousel-fade .carousel-inner > .item.active.right {
              opacity: 0;
              -webkit-transform: translate3d(0, 0, 0);
                      transform: translate3d(0, 0, 0);
            }
            .carousel-fade .carousel-inner > .item.prev,
            .carousel-fade .carousel-inner > .item.active.left {
              opacity: 0;
              -webkit-transform: translate3d(0, 0, 0);
                      transform: translate3d(0, 0, 0);
            }
            .carousel-fade .carousel-inner > .item.next.left,
            .carousel-fade .carousel-inner > .item.prev.right,
            .carousel-fade .carousel-inner > .item.active {
              opacity: 1;
              -webkit-transform: translate3d(0, 0, 0);
                      transform: translate3d(0, 0, 0);
            }
        }
        #carouselButtons {
            text-align: center;
            cursor: pointer;
        }
        #carousel-play {
            width: 70%;
            margin-top: 75px;
            margin-left: 15%;
            margin-right: auto;
            display: block;
        }
        #carousel-pause {
            width: 100%;
            margin: 75px auto;
            display: none;
        }
        /*
        .div-with-centered-content {
            display: flex;
            justify-content: center;
            align-items: center;
        }
        */
    </style>
</head>

<body>

<!-- Fixed navbar -->
<nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
        <div class="navbar-header">
            <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>
            <a class="navbar-brand" href="/">Robo-AO</a>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
            <ul class="nav navbar-nav">
                <!--<li class="active"><a href="#">Calendar</a></li>-->
                <li><a href="/">Calendar</a></li>
                <li><a href="{{date_m1}}"><span class="glyphicon glyphicon-chevron-left"></span>Previous night</a></li>
                <li><a href="{{date_p1}}">Next night<span class="glyphicon glyphicon-chevron-right"></span></a></li>
            </ul>
        </div><!--/.nav-collapse -->
    </div>
</nav>

<!-- The Bootstrap Image Gallery lightbox, should be a child element of the document body -->
<div id="blueimp-gallery" class="blueimp-gallery">
    <!-- The container for the modal slides -->
    <div class="slides"></div>
    <!-- Controls for the borderless lightbox -->
    <h3 class="title"></h3>
    <a class="prev"><</a>
    <a class="next">></a>
    <a class="close">x</a>
    <a class="play-pause">>=</a>
    <ol class="indicator"></ol>
    <!-- The modal dialog, which will be used to wrap the lightbox content -->
    <div class="modal fade">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" aria-hidden="true">&times;</button>
                    <h4 class="modal-title"></h4>
                </div>
                <div class="modal-body next"></div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default pull-left prev">
                        Previous
                    </button>
                    <button type="button" class="btn btn-primary next">
                        Next
                    </button>
                </div>
            </div>
        </div>
    </div>
</div>

<!-- Main section -->
<div class="container">

    <!--
    <div class="main-container">
        <h1>data quality</h1>
        <p class="lead">data quality stuff will appear here.<br>
            Tak-to!</p>
    </div>
    -->
    <h1>Robo-AO data quality summary: {{ date }}</h1><br>

    {% if seeing %}
    <h3>Seeing</h3>
    <!-- Seeing data -->
        Mean: {{ seeing['mean'] }}<br>
        Median: {{ seeing['median'] }}<br><br>

        <div class="row">
            <img src="/data/{{date}}/seeing/seeing.{{date}}.png" alt="seeing plot" style="height:200px;">

            <!-- data-ride="carousel"   class="slide"-->
            <div id="seeingCarousel" class="carousel  carousel-fade col-lg-8 col-offset-2"
                 data-interval="300" data-pause="false" style="width:600px;"
                 onmouseover="pauseCarouselShow();" onmouseleave="pauseCarouselHide();">
                <div class="carousel-inner">
                    <div class="item active">
                        {% set fi0 = seeing['fimages'][0] %}
                        {% set datestr = fi0[:fi0.index('.')].split('_') %}
                        {% set dat  = datestr[0][0:4]+'/'+datestr[0][4:6]+'/'+datestr[0][6:] %}
                        {% set time = datestr[1][0:2]+':'+datestr[1][2:4]+':'+datestr[1][4:] %}
                        <img src="/data/{{date}}/seeing/{{fi0}}" alt="" class="img-responsive">
                        <div class="carousel-caption" style="padding-bottom:0px !important;">
                            {{dat}}&nbsp;{{time}}</div>
                    </div>
                    {% for fi in seeing['fimages'][1:] %}
                        <div class="item">
                            {% set datestr = fi[:fi.index('.')].split('_') %}
                            {% set dat  = datestr[0][0:4]+'/'+datestr[0][4:6]+'/'+datestr[0][6:] %}
                            {% set time = datestr[1][0:2]+':'+datestr[1][2:4]+':'+datestr[1][4:] %}
                            <img src="/data/{{date}}/seeing/{{fi}}" alt="" class="img-responsive">
                            <div class="carousel-caption" style="padding-bottom:0px !important;">
                                {{dat}}&nbsp;{{time}}</div>
                        </div>
                    {% endfor %}
                </div>

                <a class="left carousel-control" href="#seeingCarousel" data-slide="prev">
                    <span class="glyphicon glyphicon-chevron-left"></span>
                </a>
                <a class="right carousel-control" href="#seeingCarousel" data-slide="next">
                    <span class="glyphicon glyphicon-chevron-right"></span>
                </a>

                <div id="carouselButtons">
                    <a id="carousel-play" class="carousel-control" onclick="playCarousel()">
                        <span class="glyphicon glyphicon-play" style="font-size: 40px !important;"></span>
                    </a>
                    <a id="carousel-pause" class="carousel-control" onclick="pauseCarousel()">
                        <span class="glyphicon glyphicon-pause" style="font-size: 40px !important;"></span>
                    </a>
                </div>
            </div>

        </div>
    {% endif %}

</div><!-- /.container -->

<div class="container">
    {% if data %}
    <!-- Scientific data -->
        {% for key in ('high_flux', 'faint')%}
            {% if key in data.keys() %}
                <h3> {{ key | replace('_', ' ') | title()}}</h3>
                <div id="{{key}}">
                    {% for source in data[key] %}
                        <a href="/data/{{date}}/{{key}}/{{ source.prog_num }}_{{ source.sou_name }}_{{ source.filter }}_{{ source.time }}_full.png"
                           title="{{ source.prog_num }}_{{ source.sou_name }}_{{ source.filter }}_{{ source.time }}" data-gallery="#gallery-{{key}}">
                            <img src="/data/{{date}}/{{key}}/{{ source.prog_num }}_{{ source.sou_name }}_{{ source.filter }}_{{ source.time }}_cropped.png"
                                 alt="{{ source.prog_num }}_{{ source.sou_name }}_{{ source.filter }}_{{ source.time }}" style="height:120px;">
                        </a>
                    {% endfor %}
                </div>
            {% endif %}
        {% endfor %}

        {% for key2 in ('zero_flux', 'failed')%}
            {% if key2 in data.keys() %}
                <h3> {{ key2 | replace('_', ' ') | title()}}</h3>
                <div id="{{key2}}">
                    {% for source in data[key2] | sort() %}
                        {{ source.prog_num }}_{{ source.sou_name }}_{{ source.filter }}_{{ source.time }}<br>
                    {% endfor %}
                </div>
            {% endif %}
        {% endfor %}

    {% endif %}


</div><!-- /.container -->

<div class="container">
    <p>&nbsp;</p>
</div><!-- /.container -->

<!-- Bootstrap core JavaScript
================================================== -->
<!-- Placed at the end of the document so the pages load faster -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
<script src="/js/jquery.blueimp-gallery.min.js"></script>
<script src="/js/bootstrap-image-gallery.min.js"></script>
<script src="/js/bootstrap.min.js"></script>
<!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
<script src="/js/ie10-viewport-bug-workaround.js"></script>

</body>
</html>
